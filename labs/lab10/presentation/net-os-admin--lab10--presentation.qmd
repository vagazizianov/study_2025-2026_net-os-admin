---
title: "Лабораторная работа №10"
author: "Газизянов Владислав Альбертович"
subtitle: "Расширенные настройки SMTP-сервера"
license: "CC BY"
date: today
date-format: "YYYY-MM-DD"
---

# Цели и задачи

**Цель:** Приобретение навыков расширенной настройки SMTP-сервера.

**Задачи:**
- Настроить Dovecot для работы с протоколом LMTP
- Реализовать SMTP-аутентификацию через SASL
- Настроить работу SMTP поверх TLS
- Автоматизировать настройку через скрипт Vagrant

![Запуск мониторинга и настройка LMTP в Dovecot](image/1.png){width=70%}

# Настройка LMTP в Dovecot

**Конфигурация протокола доставки:**
- Добавление LMTP в поддерживаемые протоколы
- Настройка сервиса LMTP для взаимодействия с Postfix
- Интеграция через Unix-сокет

![Настройка LMTP-транспорта в Postfix и перезапуск служб](image/2.png){width=70%}

# Тестирование LMTP

**Проверка работоспособности:**
- Перезапуск служб Postfix и Dovecot
- Отправка тестового письма с клиента
- Проверка доставки в почтовый ящик

![Тестирование отправки письма через LMTP](image/3.png){width=70%}

# Настройка SMTP-аутентификации

**Конфигурация SASL:**
- Настройка службы аутентификации в Dovecot
- Конфигурация параметров SASL в Postfix
- Определение ограничений получателей

![Настройка службы аутентификации SASL и параметров Postfix](image/4.png){width=70%}

# Мастер-конфигурация Postfix

**Включение аутентификации:**
- Изменение файла master.cf
- Поддержка SASL на порту 25
- Настройка ограничений доступа

![Изменение конфигурации master.cf для SASL-аутентификации](image/5.png){width=70%}

# Тестирование аутентификации

**Проверка механизма PLAIN:**
- Генерация строки аутентификации в base64
- Подключение через telnet к порту 25
- Успешная проверка учетных данных

![Генерация строки аутентификации и тестирование через telnet](image/6.png){width=70%}

# Настройка TLS

**Подготовка шифрования:**
- Копирование сертификатов из Dovecot
- Настройка параметров TLS в Postfix
- Конфигурация путей к сертификатам

![Копирование сертификатов и настройка TLS в Postfix](image/7.png){width=70%}

# Конфигурация порта submission

**Настройка защищенного доступа:**
- Запуск сервиса на порту 587
- Поддержка STARTTLS
- Обязательная аутентификация
- Правила межсетевого экрана

![Настройка порта 587 с TLS и правил FirewallD](image/8.png){width=70%}

# Тестирование TLS

**Проверка шифрования:**
- Подключение через openssl
- Проверка поддержки STARTTLS
- Аутентификация в зашифрованном канале

![Тестирование TLS-подключения через openssl](image/9.png){width=70%}

# Настройка почтового клиента

**Интеграция с Evolution:**
- Настройка порта 587
- Включение STARTTLS
- Конфигурация учётной записи

![Настройка почтового клиента Evolution для работы с TLS](image/10.png){width=70%}


# Контрольные вопросы

**Основные вопросы:**
- **Формат аутентификации с доменом:** `auth_username_format = %Ln`
- **Функции Relay-сервера:** Пересылка между системами, фильтрация, кэширование
- **Угрозы открытого ретранслятора:** Спам-рассылки, перегрузка, блокировка IP

# Выводы

**Результаты работы:**
- Настроен протокол LMTP для локальной доставки почты
- Реализована аутентификация SMTP через SASL
- Настроено шифрование через TLS на порту 587
- Создан автоматизированный сценарий развертывания
- Приобретены навыки расширенной настройки почтовых серверов
